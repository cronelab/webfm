<!DOCTYPE html>

<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="">
  <title>Mapping</title>
</head>

<body>

  <nav class="navbar navbar-inverse navbar-fixed-top">
    <!-- <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar"
          aria-expanded="false" aria-controls="navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
      </div> -->


    <a class="navbar-brand"><span class="fm-subject-name">[subject]</span> - <span
        class="fm-task-name">[task]</span></a>

    <ul class="nav navbar-nav">
      <li>
        <a class="fm-back" href="/"><span class="fas fa-bars"></span></a>
      </li>
    </ul>

    <ul class="nav navbar-nav navbar-right">
      <li class="fm-working-icon">
        <a class="glyphicon-button" href="#"><span class="glyphicon glyphicon-hourglass"></span></a>
      </li>
      <li class="fm-transfer-icon">
        <a class="glyphicon-button" href="#"><span class="glyphicon glyphicon-transfer"></span></a>
      </li>
      <li class="fm-toggle-fullscreen">
        <a class="glyphicon-button" href="#"><span class="glyphicon glyphicon-fullscreen"></span></a>
      </li>
    </ul>

  </nav>



  <nav class="navbar navbar-expand-lg navbar-light bg-light" id="optionsNav">

    <ul class=" navbar-nav">
      <li class="nav-item">
        <p class="nav-link fm-time-label"><span class="fm-time-selected">0.000 s</span></p>
      </li>
      <li class="nav-item" id="play-button">
        <a class="nav-link" href="#"><span class="fas fa-play" id="play-button-icon"></span></a>
      </li>
      <li class="nav-item fm-zoom-in">
        <a class="nav-link" href="#"><span class="fas fa-search-plus"></span></a>
      </li>
      <li class="nav-item fm-zoom-out">
        <a class="nav-link" href="#"><span class="fas fa-search-minus"></span></a>
      </li>

      <a class="nav-link" href="#" id="gainUp">
        <i class="nav-item fas fa-volume-up"></i>
      </a>
      <a class="nav-link" href="#" id="gainDown">
        <i class="nav-item fas fa-volume-down"></i>
      </a>

      <a class="nav-link fm-show-options" href="#">
        <i class="nav-item fas fa-cog"></i>
      </a>
    </ul>

  </nav>



  <div class="container-fluid">

    <div class="row">

      <div class="col-md-5 col-sm-5">

        <div id="fm"></div>

      </div>

      <div class="col-md-7 col-sm-7 hidden-xs" style="position:fixed; right:0px;">
        <!-- TODO Add aspect ratio button -->

        <div id="fm-brain"></div>

      </div>

    </div>

  </div>



  <div id="fm-options-modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="fmOptionsModal">
    <div id="fm-options-modal-dialog" class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title" id="fmOptionsModal">Settings</h4>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col-sm-3">


              <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">

                <a data-toggle="pill" role="tab" aria-controls="v-pills-profile" aria-selected="true" id="modal_options"
                  href="#fm-options-content-options" class="nav-link active">
                  Options
                </a>
                <a data-toggle="pill" role="tab" aria-controls="v-pills-profile" aria-selected="false"
                  id="modal_montage" href="#fm-options-content-montage" class="nav-link">
                  Montage
                </a>

                <a data-toggle="pill" role="tab" aria-controls="v-pills-profile" aria-selected="false" id="modal_scope"
                  href="#fm-options-content-scope" class="nav-link">
                  Scope
                </a>
                <a data-toggle="pill" role="tab" aria-controls="v-pills-profile" aria-selected="false" id="modal_save"
                  href="#fm-options-content-save" class="nav-link">
                  Save
                </a>
                <a data-toggle="pill" role="tab" aria-controls="v-pills-profile" aria-selected="false" id="modal_about"
                  href="#fm-options-content-about" class="nav-link">
                  About
                </a>

              </div>

            </div>

            <div class="col-sm-9">

              <div class="tab-content">

                <div id="fm-options-content-options" role="tabpanel" class="tab-pane active">

                  <h3 style="margin-top: 6px;">Timing</h3>
                  <p>
                    Set the windows used for clipping data relative to events, as well as for computing baseline feature
                    distributions.
                  </p>


                  <h4>Stimulus</h4>

                  <div class="form-group row">
                    <label class="col-md-3 col-sm-4 control-label">Trial window</label>
                    <label for="fm-option-stim-trial-start" class="col-md-1 col-sm-1 control-label">Start</label>
                    <div class="col-md-2 col-sm-3">
                      <input type="text" class="form-control" id="fm-option-stim-trial-start" placeholder="-1.0">
                    </div>
                    <label for="fm-option-stim-trial-end" class="col-md-1 col-sm-1 control-label">End</label>
                    <div class="col-md-2 col-sm-3">
                      <input type="text" class="form-control" id="fm-option-stim-trial-end" placeholder="3.0">
                    </div>
                  </div>

                  <div class="form-group row">
                    <label class="col-md-3 col-sm-4 control-label">Baseline</label>
                    <label for="fm-option-stim-baseline-start" class="col-md-1 col-sm-1 control-label">Start</label>
                    <div class="col-md-2 col-sm-3">
                      <input type="text" class="form-control" id="fm-option-stim-baseline-start" placeholder="-1.0">
                    </div>
                    <label for="fm-option-stim-baseline-end" class="col-md-1 col-sm-1 control-label">End</label>
                    <div class="col-md-2 col-sm-3">
                      <input type="text" class="form-control" id="fm-option-stim-baseline-end" placeholder="-0.2">
                    </div>
                  </div>

                  <div class="form-group row">
                    <div class="radio col-md-3 col-sm-4">
                      <label>
                        <input type="radio" name="fm-option-stim-timing" id="fm-option-stim-timing-state" value="state"
                          checked>
                        State timing
                      </label>
                    </div>
                    <div class="col-md-3 col-sm-7">
                      <input type="text" class="form-control" id="fm-option-stim-state" placeholder="State">
                    </div>
                    <label for="fm-option-stim-state-off"
                      class="col-md-1 col-sm-4 visible-sm visible-xs control-label text-center"></label>
                    <div class="col-md-2 col-sm-3">
                      <input type="text" class="form-control" id="fm-option-stim-state-off" placeholder="0">
                    </div>
                    <label for="fm-option-stim-state-on"
                      class="col-md-1 col-sm-1 hidden-xs control-label text-center">&xrarr;</label>
                    <div class="col-md-2 col-sm-3">
                      <input type="text" class="form-control" id="fm-option-stim-state-on" placeholder="x">
                    </div>
                  </div>

                  <div class="form-group row">
                    <div class="radio col-md-3 col-sm-4">
                      <label>
                        <input type="radio" name="fm-option-stim-timing" id="fm-option-stim-timing-signal"
                          value="signal">
                        Signal timing
                      </label>
                    </div>
                    <div class="col-md-3 col-sm-7">
                      <input type="text" class="form-control" id="fm-option-stim-channel" placeholder="Channel">
                    </div>
                    <label for="fm-option-stim-off"
                      class="col-md-1 col-sm-4 visible-sm visible-xs control-label text-center"></label>
                    <div class="col-md-2 col-sm-3">
                      <input type="text" class="form-control" id="fm-option-stim-off" placeholder="Off">
                    </div>
                    <label for="fm-option-stim-on"
                      class="col-md-1 col-sm-1 hidden-xs control-label text-center">&xrarr;</label>
                    <div class="col-md-2 col-sm-3">
                      <input type="text" class="form-control" id="fm-option-stim-on" placeholder="On">
                    </div>
                  </div>
                  <hr />

                  <h3>Event Triggers</h3>
                  <p>
                    Set options relating to how events are triggered from the received data. When using precision
                    timing, you can use the <strong><span class="glyphicon glyphicon-eye-open"></span> Scope</strong>
                    tool to identify reasonable threshold values.
                  </p>

                  <p>
                    For state timing, an on value of "<strong>x</strong>" indicates triggering on any nonzero state
                    value.
                  </p>




                  <hr />

                  <h3>Local storage</h3>
                  <p>
                    <strong>WebFM</strong> uses local storage to store commonly set
                    settings locally, so that you don't need to re-enter them
                    every time you reload the page. If you'd like to clear these
                    out and get a fresh start, hit the button below.
                  </p>
                  <p>
                    <span class="text-warning">Doing this will <strong>restart WebFM.</strong></span>
                  </p>

                  <button type="submit" class="btn btn-warning" id="fm-option-nuke-cookies"><span
                      class="glyphicon glyphicon-fire"></span>&emsp;Empty storage</button>

                </div> <!-- tabpanel (options) -->

                <div id="fm-options-content-montage" role="tabpanel" class="tab-pane">

                  <h3 style="margin-top: 6px;">Montage</h3>
                  <p>
                    <strong>Click</strong> electrodes in the list to exclude or
                    un-exclude them from the displayed channel raster.
                  </p>
                  <button id="clearExclusionButton">Clear</button>

                  <table class="table table-hover table-condensed fm-montage-table">
                    <thead>
                      <tr>
                        <th>Name</th>
                        <th>Excluded</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th scope="row">LTG01</th>
                        <td>No</td>
                      </tr>
                    </tbody>
                  </table>

                </div> <!-- tabpanel (montage) -->

                <div id="fm-options-content-scope" role="tabpanel" class="tab-pane">

                  <h3 style="margin-top: 6px;">Scope</h3>

                  <p>
                    Enter a <strong>Channel</strong> name to begin scoping live data. By default,
                    the scale will automatically adjust to match the incoming
                    signal; alternatively, you can fix the scale by entering
                    a <strong>Min</strong> or <strong>Max</strong> value.
                  </p>

                  <div class="form-group row">
                    <label for="fm-option-scope-channel" class="col-md-2 col-sm-3 control-label">Channel</label>
                    <div class="col-md-3 col-sm-7">
                      <input type="text" class="form-control" id="fm-option-scope-channel" placeholder="ainp1">
                    </div>
                    <label for="fm-option-scope-min" class="col-md-1 col-sm-3 control-label">Min</label>
                    <div class="col-md-2 col-sm-3">
                      <input type="text" class="form-control" id="fm-option-scope-min" placeholder="-100">
                    </div>
                    <label for="fm-option-scope-max" class="col-md-1 col-sm-1 control-label">Max</label>
                    <div class="col-md-2 col-sm-3">
                      <input type="text" class="form-control" id="fm-option-scope-max" placeholder="100">
                    </div>
                  </div>

                  <div id="fm-scope"></div>

                </div> <!-- tabpanel (scope) -->

                <div id="fm-options-content-save" role="tabpanel" class="tab-pane">

                  <h3 style="margin-top: 6px;">Save</h3>

                  <div class="row">

                    <div class="col-md-6">

                      <p>
                        <strong>Enter</strong> a name below to save your map to the
                        WebFM cloud.
                      </p>

                      <form class="form-inline">
                        <input type="text" class="form-control" id="fm-option-save-name" value="[Task]">
                        <button type="button" class="btn btn-default fm-save-cloud"><span
                            class="glyphicon glyphicon-cloud-upload"></span> Save</button>
                      </form>

                    </div>

                    <div class="col-md-6">

                      <table class="table table-hover table-condensed">
                        <thead>
                          <tr>
                            <th>Saved records for <span class="fm-subject-name">[subject]</span></th>
                          </tr>
                        </thead>
                        <tbody id="fm-cloud-records-table">
                        </tbody>
                      </table>

                    </div>

                  </div>

                </div>

                <div id="fm-options-content-about" role="tabpanel" class="tab-pane">

                  <h1>WebFM <small>v2.0</small></h1>

                  <p>
                    Online functional mapping
                  </p>

                  <h4 style="margin-top:20px;">Contributors</h4>
                  <dl class="row">
                    <dt class="col-sm-3"><a href="https://github.com/TheBrainChain">Chris Coogan</a></dt>
                    <dd class="col-sm-9">WebFM, BCI2000Web, bci2k.js</dd>
                    <dt class="col-sm-3"><a href="https://github.com/maxcollard">Max Collard</a></dt>
                    <dd class="col-sm-9">WebFM, bci2k.js</dd>
                    <dt class="col-sm-3"><a href="https://github.com/griffinmilsap">Griffin Milsap</a></dt>
                    <dd class="col-sm-9">BCI2000Web, bci2k.js</dd>
                    <dt class="col-sm-3"><a href="https://www.linkedin.com/in/wangyujing07/">Yujing Wang</a></dt>
                    <dd class="col-sm-9">Original Matlab implementation (OFM) </dd>
                    <dt class="col-sm-3"><a href="https://www.linkedin.com/in/matthewfifer/">Matt Fifer</a></dt>
                    <dd class="col-sm-9">Original Matlab implementation (OFM) </dd>
                    <dt class="col-sm-3"><a href="https://med.nyu.edu/faculty/adeen-flinker">Adden Flinker</a></dt>
                    <dd class="col-sm-9">Original OFM algorithm</dd>
                  </dl>
                  <hr>
                  <div class="row">
                    <div class="col-5">
                      <h4>Tech stack</h4>
                      <ul class="list-group">
                        <li class="list-group-item">
                          <a href="https://github.com/cronelab/bci2k.js">bci2k.js</a>
                        </li>

                        <li class="list-group-item">
                          <a href="https://github.com/cronelab/BCI2000Web">BCI2000Web</a>
                        </li>
                        <li class="list-group-item">
                          <a href="https://github.com/cronelab/WebFM">WebFM</a>
                        </li>
                        <li class="list-group-item">
                          <a href="https://www.bci2000.org/mediawiki/index.php/Main_Page">BCI2000</a>
                        </li>
                      </ul>
                    </div>
                    <div class="col-5">
                      <h4>Science</h4>
                      <ul class="list-group">
                        <li class="list-group-item">
                          <a href="https://n.neurology.org/content/86/13/1181.short">OFM</a>
                        </li>
                        <li class="list-group-item">
                          <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6381053/">WebFM</a>
                        </li>
                      </ul>
                    </div>
                  </div>
                  <hr>

                </div>
              </div>
            </div>
          </div>

          <div class="modal-footer">
            <button type="button" class="btn btn-primary" data-dismiss="modal">Done</button>
          </div>

        </div>
      </div>


      <script>
        //Make the DIV element draggagle:
        dragElement(document.getElementById("fm-brain"));

        function dragElement(elmnt) {
          var pos1 = 0,
            pos2 = 0,
            pos3 = 0,
            pos4 = 0;
          if (document.getElementById(elmnt.id + "header")) {
            /* if present, the header is where you move the DIV from:*/
            document.getElementById(elmnt.id + "header").onmousedown = dragMouseDown;
          } else {
            /* otherwise, move the DIV from anywhere inside the DIV:*/
            elmnt.onmousedown = dragMouseDown;
          }

          function dragMouseDown(e) {
            e = e || window.event;
            e.preventDefault();
            // get the mouse cursor position at startup:
            pos3 = e.clientX;
            pos4 = e.clientY;
            document.onmouseup = closeDragElement;
            // call a function whenever the cursor moves:
            document.onmousemove = elementDrag;
          }

          function elementDrag(e) {
            e = e || window.event;
            e.preventDefault();
            // calculate the new cursor position:
            pos1 = pos3 - e.clientX;
            pos2 = pos4 - e.clientY;
            pos3 = e.clientX;
            pos4 = e.clientY;
            // set the element's new position:
            elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
            elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";
          }

          function closeDragElement() {
            /* stop moving when mouse button is released:*/
            document.onmouseup = null;
            document.onmousemove = null;
          }
        }
      </script>
    </div>


    <!-- Footer -->

    <footer class="footer navbar-fixed-bottom">
      <div class="container-fluid">
        <p class="text-muted text-right">
          <span class="fm-trial-label">[n]</span>
          &emsp;&middot;&emsp;
          BCI2K: <span class="text-success fm-bci-status-label">Connected</span>
        </p>
      </div>
    </footer>

</body>

</html>